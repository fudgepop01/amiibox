var __extends=this&&this.__extends||function(){var e=function(t,i){e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)if(t.hasOwnProperty(i))e[i]=t[i]};return e(t,i)};return function(t,i){e(t,i);function n(){this.constructor=t}t.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var __awaiter=this&&this.__awaiter||function(e,t,i,n){function s(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,r){function o(e){try{h(n.next(e))}catch(t){r(t)}}function a(e){try{h(n["throw"](e))}catch(t){r(t)}}function h(e){e.done?i(e.value):s(e.value).then(o,a)}h((n=n.apply(e,t||[])).next())}))};var __generator=this&&this.__generator||function(e,t){var i={label:0,sent:function(){if(r[0]&1)throw r[1];return r[1]},trys:[],ops:[]},n,s,r,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(e){return function(t){return h([e,t])}}function h(o){if(n)throw new TypeError("Generator is already executing.");while(i)try{if(n=1,s&&(r=o[0]&2?s["return"]:o[0]?s["throw"]||((r=s["return"])&&r.call(s),0):s.next)&&!(r=r.call(s,o[1])).done)return r;if(s=0,r)o=[o[0]&2,r.value];switch(o[0]){case 0:case 1:r=o;break;case 4:i.label++;return{value:o[1],done:false};case 5:i.label++;s=o[1];o=[0];continue;case 7:o=i.ops.pop();i.trys.pop();continue;default:if(!(r=i.trys,r=r.length>0&&r[r.length-1])&&(o[0]===6||o[0]===2)){i=0;continue}if(o[0]===3&&(!r||o[1]>r[0]&&o[1]<r[3])){i.label=o[1];break}if(o[0]===6&&i.label<r[1]){i.label=r[1];r=o;break}if(r&&i.label<r[2]){i.label=r[2];i.ops.push(o);break}if(r[2])i.ops.pop();i.trys.pop();continue}o=t.call(e,i)}catch(a){o=[6,a];s=0}finally{n=r=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:true}}};var __spreadArrays=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;for(var n=Array(e),s=0,t=0;t<i;t++)for(var r=arguments[t],o=0,a=r.length;o<a;o++,s++)n[s]=r[o];return n};System.register(["./p-d2f484b2.system.js"],(function(e){"use strict";var t,i,n,s;return{setters:[function(e){t=e.f;i=e.r;n=e.c;s=e.h}],execute:function(){function r(e){if(e instanceof c)return true;else return false}function o(e){if(e.length>0)return e[e.length-1];return undefined}var a=function(){function e(e,t,i,n){if(i===void 0){i=0}this.offset=e;this.length=t;this.modified=i;this.myType=n;this.self=this}e.prototype.splitAt=function(e){var t=this.makeNew(this.mOffset,e);var i=this.makeNew(this.offset+e,this.length-e,this.modified);if(t.length===0){this.self=[i];return[undefined,i]}if(i.mLength===0){this.self=[t];return[t,undefined]}return this.self=[t,i]};e.prototype.isContinuedBy=function(e){if(e instanceof this.myType){return this.mLength+this.mOffset===e.mOffset&&this.editNum===e.editNum}return false};e.prototype.join=function(e){return this.self=this.makeNew(this.mOffset,this.mLength+e.mLength)};Object.defineProperty(e.prototype,"isSelf",{get:function(){return this===this.self},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"mOffset",{get:function(){return this.offset+this.modified},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"mLength",{get:function(){return this.length-this.modified},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"pieces",{get:function(){if(Array.isArray(this.self)){if(this.self.length===1)return __spreadArrays(this.self[0].pieces);return __spreadArrays(this.self[0].pieces,this.self[1].pieces)}return[this.self]},enumerable:true,configurable:true});return e}();var h=function(e){__extends(t,e);function t(i,n,s){if(s===void 0){s=0}return e.call(this,i,n,s,t)||this}t.prototype.makeNew=function(e,i,n){return new t(e,i,n)};return t}(a);var l=function(e){__extends(t,e);function t(i,n,s,r,o,a){if(o===void 0){o=[]}if(a===void 0){a=0}var h=e.call(this,i,n,a,t)||this;h.type=s;h.editNum=r;h.consumption=o;return h}t.prototype.makeNew=function(e,i,n){return new t(e,i,this.type,this.editNum,this.consumption,n)};return t}(a);var c=function(){function e(e,t,i,n){this.offset=e;this.type=t;this.editNum=i;this.index=n;this.content=[];this.consumption=[]}Object.defineProperty(e.prototype,"length",{get:function(){return this.content.length},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"modified",{get:function(){return 0},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"mLength",{get:function(){return this.length},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"mOffset",{get:function(){return this.offset},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"pieces",{get:function(){return[this]},enumerable:true,configurable:true});return e}();var u=function(){function e(e){var t=this;this.parent=e;this.added=new Uint8Array;this.pieces=[];this.undoStack=[];this.redoStack=[];this.chunk="";this.original=e.file;this.pieces=[new h(0,this.original.length)];window["rollback"]=function(){t.rollback();console.log(t.pieces)};window["ec"]=this}e.prototype.initEdit=function(e,t){var i;if(this.redoStack.length>0)this.rollback();this.inProgress=new c(this.added.length,t,this.undoStack.length+1,-1);var n=this.getPieceAtOffset(e),s=n.targetIndex,r=n.targetSlicePoint,o=n.target;if(o instanceof a){var h=o.splitAt(r);var l=void 0;if(!h[0]){this.inProgress.index=s;l=[this.inProgress,h[1]]}else if(!h[1]){this.inProgress.index=s+1;l=[h[0],this.inProgress]}else{this.inProgress.index=s+1;l=[h[0],this.inProgress,h[1]]}(i=this.pieces).splice.apply(i,__spreadArrays([s,1],l))}this.undoStack.push(this.inProgress)};e.prototype.getPieceAtOffset=function(e){var t=0;var i;var n;var s;for(var r=0,o=this.pieces.entries();r<o.length;r++){var a=o[r],h=a[0],l=a[1];t+=l.mLength;if(t>=e){i=l.mLength-t+e;n=h;s=l;break}}return{targetSlicePoint:i,targetIndex:n,target:s}};Object.defineProperty(e.prototype,"isInProgress",{get:function(){return!!this.inProgress},enumerable:true,configurable:true});e.prototype.modifyNextPiece=function(e,t,i){var n=i?i:this.inProgress;if(t!==this.pieces.length-1){var s=o(n.consumption);if(s===undefined||s.consumed){var r=this.pieces[t+1];s={consumed:false,piece:r,startMod:r.modified};n.consumption.push(s)}s.piece.modified-=e;if(s.piece.mLength===0){s.consumed=true;this.pieces.splice(t+1,1)}}};e.prototype.find=function(e,t,i){var n=[];var s=this.render(t,i?i:this.length-t).out;var r=0;for(var o=e.length;o<s.length;o++){if(s[o]===e[e.length-1]){for(var a=e.length-1;a>=0;a--){if(a===0){n.push(o+t-e.length+1);break}if(s[o-(e.length-a)]!==e[a-1]){o+=a-1;break}}}else{var h=e.lastIndexOf(s[o]);if(h===-1)o+=e.length-1;else{o+=e.length-h-2}}r++;if(r>1e5)break}return n};e.prototype.redo=function(){var e,i;if(this.redoStack.length>0){var n=this.redoStack.pop(),s=n[0],r=n[1],a=n[2];var h=this.pieces.indexOf(s);if(a.type==="insert"){(e=this.pieces).splice.apply(e,__spreadArrays([h,0],a.pieces))}else{var l=0;var c=o(a.consumption);if(!c.consumed)l=1;if(!isNaN(r)){if(!c.piece.isSelf){c.piece.pieces[0].modified=r}else{c.piece.modified=r}}(i=this.pieces).splice.apply(i,__spreadArrays([h,a.consumption.length-l],a.pieces))}this.undoStack.push(a);t(this.parent)}};e.prototype.undo=function(){var e;if(this.isInProgress){this.commit();this.chunk=""}if(this.undoStack.length>0){var i=this.undoStack.pop();var n=this.pieces.indexOf(i.pieces[0]);var s=void 0;var r=NaN;if(i instanceof l&&i.type==="overwrite"){var o=[];var a=[];for(var h=0,c=i.consumption;h<c.length;h++){var u=c[h];if(u.consumed){u.piece.modified=u.startMod;o.push(u.piece)}else{a.push(u)}}(e=this.pieces).splice.apply(e,__spreadArrays([n,i.pieces.length],o));s=this.pieces[n];if(a.length){if(!a[0].piece.isSelf){var d=a[0].piece.pieces;r=d[0].modified;d[0].modified=a[0].startMod-a[0].piece.modified}else{r=a[0].piece.modified;a[0].piece.modified=a[0].startMod}}}else{this.pieces.splice(n,i.pieces.length);s=this.pieces[n]}this.redoStack.push([s,r,i]);t(this.parent)}};e.prototype.backSpace=function(){if(this.inProgress){this.chunk="";this.inProgress.content.pop();this.parent.setCursorPosition(this.parent.cursor-1);this.modifyNextPiece(1,this.inProgress.index)}};e.prototype.buildEdit=function(e){if(!this.parent.cursor||this.parent.cursor===-1)return;if(e.key==="Z"&&(e.metaKey||e.ctrlKey)){this.redo();return}if(e.key==="z"&&(e.metaKey||e.ctrlKey)){this.undo();return}if(e.key==="Backspace"){this.backSpace();return}if(["ascii","byte"].includes(this.parent.editingMode)){if(!this.isInProgress)this.initEdit(this.parent.cursor,this.parent.editType);if(this.parent.editingMode==="ascii"&&e.key.length===1&&/[\u0000-\u00FF]/.test(e.key)){this.inProgress.content.push(e.key.charCodeAt(0));this.parent.setCursorPosition(this.parent.cursor+1);if(this.inProgress.type==="overwrite")this.modifyNextPiece(-1,this.inProgress.index)}else if(this.parent.editingMode==="byte"&&/^[a-fA-F0-9]$/.test(e.key)){this.chunk+=e.key;if(this.chunk.length===2){this.inProgress.content.push(parseInt(this.chunk,16));this.chunk="";this.parent.setCursorPosition(this.parent.cursor+1);if(this.inProgress.type==="overwrite")this.modifyNextPiece(-1,this.inProgress.index)}}}else if(this.parent.editingMode==="bit"&&["0","1","Enter"].includes(e.key)){if(e.key==="Enter"){this.initEdit(this.parent.cursor,"insert");this.inProgress.content.push(0);this.commit();t(this.parent)}else{if(!this.isInProgress)this.initEdit(this.parent.cursor,"overwrite");this.parent.setCursorPosition(this.parent.cursor,this.parent.bit+1)}}};e.prototype.commit=function(){var e=new Uint8Array(this.added.length+this.inProgress.content.length);e.set(this.added,0);e.set(this.inProgress.content,this.added.length);var t=new l(e.length-this.inProgress.length,this.inProgress.length,this.inProgress.type,this.inProgress.editNum,this.inProgress.consumption);this.pieces[this.inProgress.index]=t;this.undoStack[this.undoStack.length-1]=t;this.added=e;this.inProgress=null;this.chunk=""};e.prototype.rollback=function(){var e=0;while(this.redoStack.length>0){e+=this.redoStack.pop()[2].length}var t=new Uint8Array(this.added.length-e);t.set(this.added.subarray(0,t.length),0);this.added=t;for(var i=0;i<this.pieces.length-1;i++){var n=this.pieces[i];var s=this.pieces[i+1];if(n.isContinuedBy(s)){this.pieces.splice(i,2,n.join(s));i--}}};e.prototype.render=function(e,t){var i=new Uint8Array(t);var n={added:[]};var s=0;var o;var a=0;for(var h=0,c=this.pieces.entries();h<c.length;h++){var u=c[h],d=u[0],p=u[1];s+=p.mLength;if(s>=e){o=p.mLength-s+e;a=d;break}}if(r(this.pieces[a])||this.pieces[a]instanceof l){n.added.push([e-o,e-o+this.pieces[a].length])}var f=this.getPieceBuffer(this.pieces[a]).subarray(o,o+t);s=f.length;i.set(f,0);for(var d=a+1;d<this.pieces.length;d++){var p=this.pieces[d];s+=p.mLength;if(r(p)||p instanceof l){n.added.push([e+s-p.mLength,e+s])}if(s>=t){i.set(this.getPieceBuffer(p).subarray(0,p.mLength-s+t),s-p.mLength);break}i.set(this.getPieceBuffer(p),s-p.mLength)}if(s!==t){return{out:i.subarray(0,s),meta:n}}return{out:i,meta:n}};Object.defineProperty(e.prototype,"length",{get:function(){var e=0;for(var t=0,i=this.pieces;t<i.length;t++){var n=i[t];e+=n.length}return e},enumerable:true,configurable:true});e.prototype.save=function(){return this.render(0,this.length).out};e.prototype.getPieceBuffer=function(e){if(r(e)){return new Uint8Array(e.content)}if(e instanceof h){return this.original.subarray(e.mOffset,e.mOffset+e.mLength)}else{return this.added.subarray(e.mOffset,e.mOffset+e.mLength)}};return e}();function d(e,t,i){var n;switch(t){case 1:n=4;break;case 2:n=5;break;case 4:n=8;break;case 8:n=11;break;default:return}var s=e<0?1:0;e=Math.abs(e);var r=Math.floor(e);var o=e-r;var a=t*8-1-n-r.toString(2).length+3;var h="";for(var l=0;l<a;l++){o*=2;h+=Math.floor(o);if(o>=1)o-=1}var c=h.substring(h.length-2);h=h.substring(0,h.length-2);console.log(h,c);if(c.charAt(0)==="1"){h=(parseInt(h,2)+1).toString(2);if(/^10+$/.test(h)){r+=1;h=""}}var u=r.toString(2).length-1+(Math.pow(2,n)/2-1);if(r===0){if(h==="")u=0;else u=Math.pow(2,n)/2-1-h.match(/^(0*)/)[0].length-1}var d=u.toString(2).padStart(n,"0");var p=s+d+(r.toString(2)+h).padEnd(t*8-1-n-r.toString(2).length,"0").substring(1);console.log(s,d,(r.toString(2)+h).padEnd(t*8-1-n-r.toString(2).length,"0").substring(1));var f=[];for(var l=0;l<t*8;l+=8){f.push(parseInt(p.substring(l,l+8),2))}if(i==="little")f.reverse();if(e===0)f.fill(0);return f}var p=".fudgedit-container{overflow:hidden;position:relative;min-height:100%;color:black}.hex{font-family:'Sourcecode Pro', Courier, monospace;font-size:15px;height:100%;outline:none}.binView,.hexView,.asciiView,.lineLabels{display:inline-block;padding:0 10px;white-space:pre;position:relative}.binLine span,.hexLine span,.charLine span{position:relative;height:17px;display:inline-block}.lineLabel{height:17px}.binLine>span>span{position:relative;width:14px;padding:0 3px;-webkit-box-sizing:border-box;box-sizing:border-box}.binLine span{padding:0 0px}.binLine>span>span.padBit::after{background-color:#0006;position:absolute;width:1px;height:100%;left:calc(100% + 0.5px);content:''}.binLine>span>span:last-child.padBit::after{width:2px;left:100%}.binLine>span:last-child>span:last-child.padBit::after{display:none}.charLine span{width:10px}.hexLine span{position:relative;padding:0 5px;width:28px;-webkit-box-sizing:border-box;box-sizing:border-box}.hexLine span:not(:last-child).padByte::after{background-color:#0006;position:absolute;width:2px;height:100%;left:calc(100% - 1px);content:''}.binLine span,.hexLine span{cursor:default;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.binLine span.selected,.charLine span.selected,.hexLine span.selected{background-color:#8888FF80}.binLine span.cursor,.charLine span.cursor,.hexLine span.cursor{background-color:#008;color:#FFF}.binLine>span.added,.charLine span.added,.hexLine span.added{color:red}.binLine>span>span:hover,.charLine span:hover,.hexLine span:hover{background-color:#000;color:#FFF}.hexLine span.ASCII{font-weight:bold}.binLine:nth-child(2n-1),.hexLine:nth-child(2n-1),.charLine:nth-child(2n-1),.lineLabel:nth-child(2n-1){background-color:#EEFFFF;mix-blend-mode:multiply}.binLine.selected,.charLine.selected,.hexLine.selected,.lineLabel.selected{background-color:#FFA}.separator{opacity:0;pointer-events:none}.region{opacity:1}.highlight{mix-blend-mode:multiply}.region{position:relative}.highlight:hover .region:not(:hover){fill:#0003}.find{width:calc(100% - 20px);height:50px;position:absolute;bottom:0;left:0;right:0;margin:auto;background-color:#fff;z-index:4}";var f=e("fudge_hex_editor",function(){function e(e){var t=this;i(this,e);this.lineNumber=0;this.searchType="ascii";this.searchByteCount=1;this.searchEndian="big";this.searchInput="";this.searchResults=[];this.searchActive=false;this.displayAscii=true;this.displayHex=true;this.displayBin=false;this.maxLines=30;this.bytesPerLine=16;this.chunks=[];this.displayAsChunks=false;this.asciiInline=false;this.bytesPerGroup=4;this.bitsPerGroup=8;this.mode="select";this.editType="readonly";this.regionDepth=2;this.regions=[];this.scroll=function(e){e.preventDefault();var i=!Number.isInteger(e.deltaY)?Math.ceil(e.deltaY/100):Math.ceil(e.deltaY/2);if(i===-0)i-=1;if(t.lineNumber+i<0)t.lineNumber=0;else if(t.lineNumber+i>Math.floor(t.editController.length/t.bytesPerLine)-1)t.lineNumber=Math.floor(t.editController.length/t.bytesPerLine)-1;else t.lineNumber+=i};this.hexLineChanged=n(this,"hexLineChanged",7);this.hexCursorChanged=n(this,"hexCursorChanged",7);this.hexSelectionChanged=n(this,"hexSelectionChanged",7);this.hexDataChanged=n(this,"hexDataChanged",7);this.hexLoaded=n(this,"hexLoaded",7)}e.prototype.componentWillLoad=function(){this.file=new Uint8Array(1024).map((function(e,t){return t%256}));this.editController=new u(this);this.regionScaleWidth=28;this.regionScaleHeight=17};e.prototype.componentDidLoad=function(){this.hexLoaded.emit(this.editController)};e.prototype.acceptFile=function(e){return __awaiter(this,void 0,void 0,(function(){var t;var i=this;return __generator(this,(function(n){console.log(e);this.fileMetadata=e;t=new FileReader;t.readAsArrayBuffer(e);t.onload=function(e){i.file=new Uint8Array(e.target.result);i.editController=new u(i)};return[2]}))}))};e.prototype.saveFile=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){if(this.file==undefined)return[2];return[2,this.editController.save()]}))}))};e.prototype.setLineNumber=function(e){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){if(e<0)this.lineNumber=0;else this.lineNumber=e;this.hexLineChanged.emit(this.lineNumber);return[2]}))}))};e.prototype.setCursorPosition=function(e,t){return __awaiter(this,void 0,void 0,(function(){var i;return __generator(this,(function(n){if(t){i=0;if(t>=8)i=Math.floor(t/8);this.cursor=e+i;this.bit=t%8}else{this.cursor=e}this.hexCursorChanged.emit({byte:this.cursor,bit:this.bit});return[2]}))}))};e.prototype.setSelection=function(e){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){this.selection=Object.assign(Object.assign({},this.selection),e);this.hexSelectionChanged.emit(this.selection);return[2]}))}))};e.prototype.getChunk=function(e,t){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(i){return[2,this.editController.render(e,t)]}))}))};e.prototype.getFileMetadata=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){return[2,this.fileMetadata]}))}))};e.prototype.executeSearch=function(e,t,i,n,s){return __awaiter(this,void 0,void 0,(function(){var r;return __generator(this,(function(o){try{r=this.formatSearch(e,t,n,s)}catch(a){console.log(a)}this.searchResults=this.editController.find(r,i?i[0]:0,i?i[1]-i[0]:undefined);return[2,this.searchResults]}))}))};e.prototype.buildHexView=function(){var e=this;var t=this,i=t.lineNumber,n=t.maxLines,r=t.bytesPerLine,o=t.bytesPerGroup,a=t.bitsPerGroup,h=t.asciiInline;var l=i*r;var c=this.editController.render(l,n*r);var u=c.out;var d=c.meta.added;var p=[];for(var f=0;f<n;f++){p.push(u.subarray(f*r,(f+1)*r))}var g=[];var v=[];var b=[];var y=-1;for(var m=0,x=p.entries();m<x.length;m++){var L=x[m],w=L[0],S=L[1];if(S.length===0)break;var P=l+w*r;var k=[];var _=[];var C=[];var M="•";for(var A=0,B=__spreadArrays(S.values()).entries();A<B.length;A++){var I=B[A],E=I[0],N=I[1];var O=void 0;if(/\w|[!@#$%^&*()_+=\]\\:;"'>.<,/?]/.test(String.fromCharCode(N))){M=String.fromCharCode(N)}else{M="•"}if(h&&/\w/.test(M)){O="."+M}else{O=N.toString(16).toUpperCase().padStart(2,"0")}var R=[];if(O.startsWith("."))R.push("ASCII");if(E%o===o-1)R.push("padByte");if(Math.floor(this.cursor)===P+E){R.push("cursor");y=w}if(this.selection&&this.selection.start<=P+E&&P+E<=this.selection.end)R.push("selected");for(var F=0,H=d;F<H.length;F++){var j=H[F],U=j[0],D=j[1];if(U<=P+E&&P+E<D){R.push("added");break}}var V=N.toString(2).padStart(8,"0").split("");var z=[];if(this.displayBin){for(var f=0;f<V.length;f++){var T="";if((E*8+f)%a==a-1)T+="padBit";if(R.includes("cursor")&&(this.bit===f||this.bit===-1))T+=" cursor";if(R.includes("selected")){if(this.selection.start===this.selection.end){if(f>=this.selection.startBit&&f<=this.selection.endBit)T+=" selected"}else if(this.selection.start===P+E){if(f>=this.selection.startBit)T+=" selected"}else if(this.selection.end===P+E){if(f<=this.selection.endBit||this.selection.endBit===-1)T+=" selected"}else T+=" selected"}z.push(s("span",{"data-cursor-idx":f,class:T},V[f]))}}if(this.displayBin)k.push(s("span",{"data-cursor-idx":P+E,class:"binGroup"+(R.includes("added")?" added":"")},z));if(this.displayAscii)_.push(s("span",{"data-cursor-idx":P+E,class:R.join(" ")},M));if(this.displayHex)C.push(s("span",{"data-cursor-idx":P+E,class:R.join(" ")},O))}if(this.displayBin)g.push(s("div",{class:"binLine"+(y===w?" selected":"")},k));if(this.displayHex){v.push(s("div",{class:"hexLine"+(y===w?" selected":"")},C))}else{v.push({})}if(this.displayAscii)b.push(s("div",{class:"charLine"+(y===w?" selected":"")},_))}while(v.length<n){g.push(s("div",{class:"binLine",style:{pointerEvents:"none"}},s("span",null,"-")));v.push(s("div",{class:"hexLine",style:{pointerEvents:"none"}},s("span",null,"-")));b.push(s("div",{class:"charLine",style:{pointerEvents:"none"}},s("span",null,"-")))}var G=[];for(var f=0;f<n;f++){G.push(s("div",{class:"lineLabel"+(y===f?" selected":""),style:{pointerEvents:"none"}},"0x"+(l+f*r).toString(16).padStart(8," ")))}var W=[];var K=[];var Y=[];var $=function(t,n,r){if(n===void 0){n=0}if(t.end<l||t.start>l+e.maxLines*e.bytesPerLine){if(t.subRegions&&n+1!==e.regionDepth){for(var o=0,a=t.subRegions.entries();o<a.length;o++){var h=a[o],c=h[0],u=h[1];$(u,n+1,c)}}return}if(n===e.regionDepth)return;var d=t.start%e.bytesPerLine;var p=t.end%e.bytesPerLine;var f=Math.floor((t.end-t.start+d)/e.bytesPerLine);var g=Math.floor(t.start/e.bytesPerLine)-i;var v={0:["#88F","#BBF"],1:["#F88","#FBB"],2:["#8D8","#BDB"]};var b=function(i,o){return s("polygon",{onMouseMove:function(i){if(e.canUpdateMouseMove===undefined){e.canUpdateMouseMove=true}if(e.canUpdateMouseMove){e.canUpdateMouseMove=false;document.documentElement.style.setProperty("--mouse-x",""+i.clientX);document.documentElement.style.setProperty("--mouse-y",""+i.clientY);document.getElementById("tooltip").setAttribute("active","true");document.getElementById("tooltip").setAttribute("complex",""+JSON.stringify(Object.assign(Object.assign({},t),{subRegions:t.subRegions?t.subRegions.map((function(e){return e.name})):null})));setTimeout((function(){e.canUpdateMouseMove=true}),50)}},onMouseLeave:function(){return document.getElementById("tooltip").setAttribute("active","false")},class:"region",points:"\n              0,"+(1+g)*o+"\n              "+d*i+","+(1+g)*o+"\n              "+d*i+","+g*o+"\n              "+e.bytesPerLine*i+","+g*o+"\n              "+e.bytesPerLine*i+","+(f+g)*o+"\n              "+p*i+","+(f+g)*o+"\n              "+p*i+","+(f+g+1)*o+"\n              0,"+(f+1+g)*o+"\n            ",fill:t.color||v[n%3][r%2],stroke:"none"})};W.push(b(14*8,e.regionScaleHeight));K.push(b(e.regionScaleWidth,e.regionScaleHeight));Y.push(b(10,e.regionScaleHeight));if(t.subRegions&&n+1!==e.regionDepth){for(var y=0,m=t.subRegions.entries();y<m.length;y++){var x=m[y],c=x[0],u=x[1];$(u,n+1,c)}}};for(var J=0,X=this.regions.entries();J<X.length;J++){var Z=X[J],f=Z[0],q=Z[1];$(q,0,f)}var Q=s("svg",{viewBox:"0 0 "+this.bytesPerLine*14*8+" "+this.maxLines*this.regionScaleHeight,width:""+this.bytesPerLine*14*8,height:""+this.maxLines*this.regionScaleHeight},W);var ee=s("svg",{viewBox:"0 0 "+this.bytesPerLine*this.regionScaleWidth+" "+this.maxLines*this.regionScaleHeight,width:""+this.bytesPerLine*this.regionScaleWidth,height:""+this.maxLines*this.regionScaleHeight},K);var te=s("svg",{viewBox:"0 0 "+this.bytesPerLine*10+" "+this.maxLines*this.regionScaleHeight,width:""+this.bytesPerLine*10,height:""+this.maxLines*this.regionScaleHeight},Y);return{lineViews:v,charViews:b,binViews:g,lineLabels:G,binRegions:Q,hexRegions:ee,asciiRegions:te}};e.prototype.buildChunks=function(){var e=this;var t=this,i=t.lineNumber,n=t.maxLines,r=t.bytesPerLine,o=t.bytesPerGroup,a=t.chunks,h=t.bitsPerGroup,l=t.asciiInline;var c={chunk:0,chunkLineOffs:0};for(var u=i,d=0;u>0&&d<a.length;u--,d++){var p=Math.floor((a[d].end-a[d].start)/r)+1;u-=p;if(u>0)c.chunk+=1;else c.chunkLineOffs=p-u*-1}var f=[];for(var g=c.chunk,v=0;v<n&&g<a.length;g++){var b=v;var y=a[g];var m=y.start;if(g==c.chunk)m+=r*c.chunkLineOffs;if(y.end-m<=0){continue}v+=Math.ceil((y.end-m)/r);var x=y.end;if(v>n)x-=(v-n)*r;var L=this.editController.render(m,x-m).out;f.push({start:m,data:L,startLine:b,endLine:v});for(var d=0;d<1;d++){v+=1;f.push({data:new Uint8Array(0),start:-1,startLine:-1,endLine:-1})}}f.pop();var w=[];var S=[];var P=[];var k=[];var _=[];var C=[];var M=[];var A=function(t,i,n){if(t===-1){k.push(s("div",{class:"separator",style:{pointerEvents:"none"}},"NA"));w.push(s("div",{class:"separator",style:{pointerEvents:"none"}},"NA"));S.push(s("div",{class:"separator",style:{pointerEvents:"none"}},"NA"));P.push(s("div",{class:"separator",style:{pointerEvents:"none"}},"NA"));return"continue"}for(var a=0;a<i.length;a+=r){var c=t+a;var u=[];var d=[];var p=[];var f=-1;for(var g=a;g<a+r&&g<i.length;g++){var v=i[g];var b=t+g;var y=void 0;var m=void 0;if(/\w|[!@#$%^&*()_+=\]\\:;"'>.<,/?]/.test(String.fromCharCode(v))){m=String.fromCharCode(v)}else{m="•"}if(l&&/\w/.test(m)){y="."+m}else{y=v.toString(16).toUpperCase().padStart(2,"0")}var x=[];if(y.startsWith("."))x.push("ASCII");if((g-a)%o===o-1)x.push("padByte");if(Math.floor(B.cursor)===b){x.push("cursor");f=c}if(B.selection&&B.selection.start<=b&&b<=B.selection.end)x.push("selected");var L=v.toString(2).padStart(8,"0").split("");var A=[];if(B.displayBin){for(var I=0;I<L.length;I++){var E="";if((b*8+I)%h==h-1)E+="padBit";if(x.includes("cursor")&&(B.bit===I||B.bit===-1))E+=" cursor";if(x.includes("selected")){if(B.selection.start===B.selection.end){if(I>=B.selection.startBit&&I<=B.selection.endBit)E+=" selected"}else if(B.selection.start==b){if(I>=B.selection.startBit)E+=" selected"}else if(B.selection.end==b){if(I<=B.selection.endBit||B.selection.endBit===-1)E+=" selected"}else E+=" selected"}A.push(s("span",{"data-cursor-idx":I,class:E},L[I]))}}if(B.displayBin)p.push(s("span",{"data-cursor-idx":b,class:"binGroup"+(x.includes("added")?" added":"")},A));if(B.displayAscii)d.push(s("span",{"data-cursor-idx":b,class:x.join(" ")},m));if(B.displayHex)u.push(s("span",{"data-cursor-idx":b,class:x.join(" ")},y))}k.push(s("div",{class:"lineLabel"+(f===c?" selected":""),style:{pointerEvents:"none"}},"0x"+c.toString(16).padStart(8," ")));if(B.displayBin)P.push(s("div",{class:"binLine"+(f===c?" selected":"")},p));if(B.displayHex){w.push(s("div",{class:"hexLine"+(f===c?" selected":"")},u))}else{w.push({})}if(B.displayAscii)S.push(s("div",{class:"charLine"+(f===c?" selected":"")},d))}var N=function(o,a,h){if(a===void 0){a=0}var l=Math.floor(i.length/r);var c=t%r;if(o.end<t||o.start>t+l*r){if(o.subRegions&&a+1!==e.regionDepth){for(var u=0,d=o.subRegions.entries();u<d.length;u++){var p=d[u],f=p[0],g=p[1];N(g,a+1,f)}}return}if(a===e.regionDepth)return;var v=Math.max(o.start,t);var b=Math.min(o.end,t+i.length);var y=(v-c)%r;var m=(b-c)%r;var x=Math.floor((b-v+y)/r);var L=Math.floor((v-t)/r)+n;var w={0:["#88F","#BBF"],1:["#F88","#FBB"],2:["#8D8","#BDB"]};var S=function(t,i){return s("polygon",{onMouseMove:function(t){if(e.canUpdateMouseMove===undefined){e.canUpdateMouseMove=true}if(e.canUpdateMouseMove){e.canUpdateMouseMove=false;document.documentElement.style.setProperty("--mouse-x",""+t.clientX);document.documentElement.style.setProperty("--mouse-y",""+t.clientY);document.getElementById("tooltip").setAttribute("active","true");document.getElementById("tooltip").setAttribute("complex",""+JSON.stringify(Object.assign(Object.assign({},o),{subRegions:o.subRegions?o.subRegions.map((function(e){return e.name})):null})));setTimeout((function(){e.canUpdateMouseMove=true}),50)}},onMouseLeave:function(){return document.getElementById("tooltip").setAttribute("active","false")},class:"region",points:"\n              0,"+(1+L)*i+"\n              "+y*t+","+(1+L)*i+"\n              "+y*t+","+L*i+"\n              "+e.bytesPerLine*t+","+L*i+"\n              "+e.bytesPerLine*t+","+(x+L)*i+"\n              "+m*t+","+(x+L)*i+"\n              "+m*t+","+(x+L+1)*i+"\n              0,"+(x+1+L)*i+"\n            ",fill:o.color||w[a%3][h%2],stroke:"none"})};_.push(S(14*8,e.regionScaleHeight));C.push(S(e.regionScaleWidth,e.regionScaleHeight));M.push(S(10,e.regionScaleHeight));if(o.subRegions&&a+1!==e.regionDepth){for(var P=0,k=o.subRegions.entries();P<k.length;P++){var A=k[P],f=A[0],g=A[1];N(g,a+1,f)}}};for(var O=0,R=B.regions.entries();O<R.length;O++){var F=R[O],a=F[0],H=F[1];N(H,0,a)}};var B=this;for(var I=0,E=f;I<E.length;I++){var N=E[I],O=N.start,R=N.data,b=N.startLine;A(O,R,b)}while(w.length<n){k.push(s("div",{class:"separator"},s("span",null,"-")));P.push(s("div",{class:"separator"},s("span",null,"-")));w.push(s("div",{class:"separator"},s("span",null,"-")));S.push(s("div",{class:"separator"},s("span",null,"-")))}var F=s("svg",{viewBox:"0 0 "+this.bytesPerLine*14*8+" "+this.maxLines*this.regionScaleHeight,width:""+this.bytesPerLine*14*8,height:""+this.maxLines*this.regionScaleHeight},_);var H=s("svg",{viewBox:"0 0 "+this.bytesPerLine*this.regionScaleWidth+" "+this.maxLines*this.regionScaleHeight,width:""+this.bytesPerLine*this.regionScaleWidth,height:""+this.maxLines*this.regionScaleHeight},C);var j=s("svg",{viewBox:"0 0 "+this.bytesPerLine*10+" "+this.maxLines*this.regionScaleHeight,width:""+this.bytesPerLine*10,height:""+this.maxLines*this.regionScaleHeight},M);return{lineViews:w,charViews:S,binViews:P,lineLabels:k,binRegions:F,hexRegions:H,asciiRegions:j}};e.prototype.edit=function(e){var i=this;if(e.target.className!=="hex")return;var n={ArrowDown:function(){i.setCursorPosition(i.cursor+i.bytesPerLine>i.editController.length?i.editController.length:i.cursor+i.bytesPerLine)},ArrowUp:function(){i.setCursorPosition(i.cursor-i.bytesPerLine<0?0:i.cursor-i.bytesPerLine)},ArrowRight:function(){i.setCursorPosition(i.cursor+1>i.editController.length?i.editController.length:i.cursor+1)},ArrowLeft:function(){i.setCursorPosition(i.cursor-1<0?0:i.cursor-1)}};if(n[e.key]){e.preventDefault();if(this.editController.inProgress)this.editController.commit();n[e.key]();if(this.cursor>(this.lineNumber+this.maxLines)*this.bytesPerLine-1)this.setLineNumber(Math.floor(this.cursor/this.bytesPerLine)-this.maxLines+1);else if(this.cursor<this.lineNumber*this.bytesPerLine)this.setLineNumber(Math.floor(this.cursor/this.bytesPerLine));if(e.shiftKey){if(this.selection.start>this.cursor)this.setSelection({start:this.cursor});else this.setSelection({end:this.cursor})}else{this.setSelection({start:this.cursor,end:this.cursor})}}else if((e.ctrlKey||e.metaKey)&&e.key==="f"){e.preventDefault();this.searchActive=!this.searchActive;t(this)}else{if(this.editType==="readonly")return;e.preventDefault();this.editController.buildEdit(e)}};e.prototype.formatSearch=function(e,t,i,n){if(e.length===0)throw new Error("LEN0: there needs to be something to search for...");switch(t){case"integer":var s=parseInt("0x"+new Array(i+1).join("FF"),16);var r=parseInt(e);if(Math.abs(r)>s){r=s*Math.sign(r)}var o=r.toString(16).padStart(2*i,"0").match(/.{2}/g).map((function(e){return parseInt(e,16)}));if(n==="little")o.reverse();return o;case"float":return d(parseFloat(e),i,n);case"byte":if(/[^0-9a-f ,|;]/gi.test(e))throw new Error("UC: Unexpected Character (must be exclusively 0-9 and a-f)");else{return e.replace(/[ ,|;]/gi,"").match(/.{2}/g).map((function(e){return parseInt(e,16)}))}case"ascii":default:return e.split("").map((function(e){return e.charCodeAt(0)}))}};e.prototype.findInSelection=function(){return __awaiter(this,void 0,void 0,(function(){var e,t;return __generator(this,(function(i){switch(i.label){case 0:e=this.selection?this.selection.end-this.selection.start:0;t=this;return[4,this.executeSearch(this.searchInput,this.searchType,e===0?undefined:[this.selection.start,this.selection.end],this.searchByteCount,this.searchEndian)];case 1:t.searchResults=i.sent();return[2]}}))}))};e.prototype.showHex=function(){var e=this;var t=this.buildHexView(),i=t.lineViews,n=t.binViews,r=t.charViews,o=t.lineLabels,a=t.binRegions,h=t.hexRegions,l=t.asciiRegions;var c;try{c=this.formatSearch(this.searchInput,this.searchType,this.searchByteCount,this.searchEndian).map((function(e){return e.toString(16).padStart(2,"0")})).join(", ")}catch(p){if(p.message.startsWith("LEN0"))c="";else c=p.message}var u;if(this.searchActive){var d=function(t){var i=parseInt(t);e.setCursorPosition(i);e.setSelection({start:i,end:i+(["integer","float"].includes(e.searchType)?e.searchByteCount:e.searchInput.length)-1,startBit:-1,endBit:-1});e.setLineNumber(Math.floor(i/e.bytesPerLine)-e.maxLines/2)};u=s("select",{onChange:function(e){return d(e.target.value)}},this.searchResults.map((function(e){return s("option",{value:e},"0x"+e.toString(16))})))}return s("div",{class:"hex",onMouseEnter:function(t){return e._toggleScrollListener(t)},onMouseLeave:function(t){return e._toggleScrollListener(t)},onMouseDown:function(t){return e.beginSelection(t)},onMouseUp:function(t){return e.endSelection(t)},tabindex:"0",onKeyDown:function(t){return e.edit(t)}},s("div",{id:"MEASURE",class:"hex",style:{position:"absolute",visibility:"hidden",padding:"0 5px"}},"AB"),s("div",{class:"lineLabels"},o),this.displayBin?s("div",{class:"binView"},s("div",{class:"highlight",style:{position:"absolute",top:"0",display:this.mode==="noregion"?"none":"block",zIndex:this.mode==="region"?"3":"0"}},a),s("div",{class:"main"},n)):null,this.displayHex?s("div",{class:"hexView"},s("div",{class:"highlight",style:{position:"absolute",top:"0",display:this.mode==="noregion"?"none":"block",zIndex:this.mode==="region"?"3":"0"}},h),s("div",{class:"main"},i)):null,this.displayAscii?s("div",{class:"asciiView"},s("div",{class:"highlight",style:{position:"absolute",top:"0",display:this.mode==="noregion"?"none":"block",zIndex:this.mode==="region"?"3":"0"}},l),s("div",{class:"main"},r)):null,this.searchActive?s("div",{class:"find"},"search:",s("input",{type:"text",onChange:function(t){return e.searchInput=t.target.value}}),s("select",{onChange:function(t){return e.searchType=t.target.value}},s("option",{value:"ascii"},"ASCII string"),s("option",{value:"byte"},"bytes"),s("option",{value:"integer"},"integer"),s("option",{value:"float"},"float")),["integer","float"].includes(this.searchType)?[s("select",{onChange:function(t){return e.searchByteCount=parseInt(t.target.value)}},s("option",{value:"1"},"1 byte"),s("option",{value:"2"},"2 bytes"),s("option",{value:"4"},"4 bytes"),s("option",{value:"8"},"8 bytes")),s("select",{onChange:function(t){return e.searchEndian=t.target.value}},s("option",{value:"big"},"big endian"),s("option",{value:"little"},"little endian"))]:null,s("button",{onClick:function(){return e.findInSelection()}},"search"),s("br",null),"hex: ",c," | results: ",u):null)};e.prototype.showChunks=function(){var e=this;var t=this.buildChunks(),i=t.lineViews,n=t.binViews,r=t.charViews,o=t.lineLabels,a=t.binRegions,h=t.hexRegions,l=t.asciiRegions;return s("div",{class:"hex",onMouseEnter:function(t){return e._toggleScrollListener(t)},onMouseLeave:function(t){return e._toggleScrollListener(t)},onMouseDown:function(t){return e.beginSelection(t)},onMouseUp:function(t){return e.endSelection(t)},tabindex:"0",onKeyDown:function(t){return e.edit(t)}},s("div",{id:"MEASURE",class:"hex",style:{position:"absolute",visibility:"hidden",padding:"0 5px"}},"AB"),s("div",{class:"lineLabels"},o),this.displayBin?s("div",{class:"binView"},s("div",{class:"highlight",style:{position:"absolute",top:"0",display:this.mode==="noregion"?"none":"block",zIndex:this.mode==="region"?"3":"0"}},a),s("div",{class:"main"},n)):null,this.displayHex?s("div",{class:"hexView"},s("div",{class:"highlight",style:{position:"absolute",top:"0",display:this.mode==="noregion"?"none":"block",zIndex:this.mode==="region"?"3":"0"}},h),s("div",{class:"main"},i)):null,this.displayAscii?s("div",{class:"asciiView"},s("div",{class:"highlight",style:{position:"absolute",top:"0",display:this.mode==="noregion"?"none":"block",zIndex:this.mode==="region"?"3":"0"}},l),s("div",{class:"main"},r)):null)};e.prototype.beginSelection=function(e){if(e.target.id==="HEX-SCROLLBAR")return;var t=e.target.parentElement.className;if(t.includes("charLine"))this.editingMode="ascii";else if(t.includes("hexLine"))this.editingMode="byte";else if(t.includes("binGroup"))this.editingMode="bit";else return;if(this.editingMode==="bit"){this.tempSelection={byte:parseInt(e.composedPath()[1].getAttribute("data-cursor-idx")),bit:parseInt(e.target.getAttribute("data-cursor-idx"))}}else{this.tempSelection={byte:parseInt(e.target.getAttribute("data-cursor-idx")),bit:-1}}};e.prototype.endSelection=function(e){if(this.tempSelection===null)return;var t=e.target.parentElement.className;if(t.includes("charLine"))this.editingMode="ascii";else if(t.includes("hexLine"))this.editingMode="byte";else if(t.includes("binGroup"))this.editingMode="bit";else return;var i;if(this.editingMode==="bit"){i={byte:parseInt(e.composedPath()[1].getAttribute("data-cursor-idx")),bit:parseInt(e.target.getAttribute("data-cursor-idx"))}}else{i={byte:parseInt(e.target.getAttribute("data-cursor-idx")),bit:-1}}if(this.tempSelection.byte+this.tempSelection.bit/10>i.byte+i.bit/10){this.setSelection({start:i.byte,startBit:i.bit,end:this.tempSelection.byte,endBit:this.tempSelection.bit})}else{this.setSelection({start:this.tempSelection.byte,startBit:this.tempSelection.bit,end:i.byte,endBit:i.bit})}this.tempSelection=null;this.cursor=i.byte;this.bit=i.bit;this.hexCursorChanged.emit({byte:this.cursor,bit:this.bit});this.hexSelectionChanged.emit(this.selection);if(this.editController.isInProgress){this.editController.commit();this.hexDataChanged.emit()}};e.prototype.render=function(){var e;if(this.displayAsChunks)e=this.showChunks();else e=this.showHex();return s("div",{class:"fudgedit-container"},e)};e.prototype._toggleScrollListener=function(e){if(e.type==="mouseenter")e.target.addEventListener("wheel",this.scroll,{passive:false});else e.target.removeEventListener("wheel",this.scroll,false)};return e}());f.style=p;var g="fudge-hex-tooltip{position:fixed;display:none;-webkit-box-sizing:border-box;box-sizing:border-box;font-size:14px;max-width:400px;padding:5px;border-radius:2px;background-color:#000;color:white;z-index:1000;pointer-events:none}fudge-hex-tooltip[active=true]{display:block;left:calc(var(--mouse-x) * 1px);top:calc(var(--mouse-y) * 1px);-webkit-transition:.2s left ease, .2s top ease;transition:.2s left ease, .2s top ease}";var v=e("fudge_hex_tooltip",function(){function e(e){i(this,e);this.active=false}e.prototype.render=function(){if(!this.active)return;var e=[];if(this.data){var t=typeof this.data==="string"?JSON.parse(this.data):this.data;if(t.name)e.push(s("span",null,"name: "+t.name),s("br",null));e.push(s("span",null,"size: "+(t.end-t.start)+" [0x"+t.start.toString(16)+" - 0x"+t.end.toString(16)+"]"),s("br",null));for(var i=0,n=Object.entries(t);i<n.length;i++){var r=n[i],o=r[0],a=r[1];if(["name","subRegions","start","end"].includes(o))continue;if(a!==null){e.push(s("span",null,o,": ",a),s("br",null))}}}else if(this.simpleText){e.push(s("span",null,this.simpleText))}else{e.push(s("span",null,"placeholder"))}return e};return e}());v.style=g}}}));